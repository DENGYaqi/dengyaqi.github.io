---
title: 20分钟了解Java容器
date: 2024-09-03 10:00:00 +0800
categories: [Java Collections Framework]
tags: [java]
description: Java容器
pin: true
---

## 介绍
上一篇讲完了Java基础的核心思想，这一篇主要介绍Java容器的概念，和主要容器的实现方式与其数据结构。

## Java容器
Java 容器是 Java 集合框架（Java Collections Framework，简称 JCF）的核心组成部分，用于存储和操作一组数据对象。Java 容器提供了灵活的接口和实现类，支持各种数据结构，如列表、集合、映射、队列等。容器通常分为两类：Collection 容器和 Map 容器。

## Collection容器
Collection 是 Java 容器的基础接口，表示一组对象的集合。Collection 容器包括三个主要子接口：List、Set 和 Queue。

### List 接口
List 是一种有序的集合，允许重复元素。List 维护元素的插入顺序，支持基于索引的访问和操作。常见的实现类有：

  - ArrayList：基于动态数组实现，支持快速随机访问，适合频繁读取和少量插入删除的场景。
  - LinkedList：基于双向链表实现，适合频繁插入和删除操作的场景。
  - Vector：类似于 ArrayList，但是线程安全的，已较少使用。

### 数据结构原理

#### 1. ArrayList的动态数组
ArrayList的动态数组机制使得它在不确定集合大小的场景时非常适用，但扩展时会有额外的性能开销，因此初始化时预估合适的容量可以提高性能。

  - 动态扩展机制
    - 检查容量 : 添加元素前，若空间足够则直接添加，若空间不足，则扩容。
    - 扩容 : 一般扩大1.5倍后，将现有元素复制到新数组中，通过`System.arraycopy()`实现。若新容量仍然不足以容纳即将添加的元素，则将其设置为所需的最小容量。
  
  - 动态收缩机制
    - `ArrayList`不会自动收缩，可调用`trimToSize()`方法减小数组的占用空间。
   
  - 算法
    - 添加单个元素的平均时间复杂度：O(1)
    - 扩容时的时间复杂度：O(n)

  - 优化 : 每次扩容涉及大量的内存分配和数据复制操作，若能够预估存储的数据量，可以在初始化时指定初始容量来减少扩容次数。

  - 场景示例
    - 存储和管理学生成绩，例如学校管理系统中，可能需要存储和管理大量学生的成绩。由于学生数量可能不固定，而且需要频繁地按照学生索引访问他们的成绩。
    - 实现简单的队列功能，例如在一些简单场景中，可以使用 ArrayList 实现一个基本的 FIFO（先进先出）队列。
    - 用作缓存，在缓存大小有限时，可以通过 remove 和 add 方法来维护缓存的最近使用状态。这种用法在需要对数据进行快速访问且能够容忍简单淘汰策略的场景中非常有效。

#### 2. LinkedList的双向链表
链表数据结构，其中每个节点都包含对前一个节点和后一个节点的引用。这种结构允许我们从任意一个节点开始，既可以向前遍历链表，也可以向后遍历链表，它在需要多方向操作的应用中非常有用。

  - 基本结构
    - 数据部分（data/item）：存储节点的实际数据。
    - 前驱指针（prev）：指向链表中前一个节点。
    - 后继指针（next）：指向链表中后一个节点。

  - 实现原理(头结点/尾结点)
    - 头节点（first）：链表中的第一个节点，它的 prev 指针为 null。
    - 尾节点（last）：链表中的最后一个节点，它的 next 指针为 null。

  - 场景示例
    - 浏览器的前进和后退功能，例如浏览器的历史记录管理，每个节点代表一个浏览历史中的页面，当前页面用一个指针（current）来表示。

#### 3. Vector
与 ArrayList 类似，也是基于动态数组的实现，但有几个关键的区别和特点，使得它在某些场景中具有不同的使用价值。由于 Vector 是线程安全的，它适用于多线程环境下需要频繁修改和访问集合的场景。但是同步开销不小，所以适用于大多数单线程或读多写少的场景中。如果确实需要线程安全的集合，通常建议使用更灵活的同步策略，如 `Collections.synchronizedList` 或 `CopyOnWriteArrayList`。

  - 特点
    - 同步 : Vector 的所有方法都是同步的synchronized，多个线程可以安全地同时访问和修改 Vector 对象，而不需要额外的同步控制。
    - 动态数组 : 与 ArrayList 的区别在于扩容两倍，并且可以控制扩容幅度，也就是指定增量大小。
    - API一致性 : Vector 类实现了 List 接口，因此它具有 List 的所有功能，如索引访问、遍历等。它也实现了 RandomAccess 接口，这意味着它支持快速随机访问元素。

  - 场景示例
    - 多线程日志记录，例如在一个多线程应用中，多个线程可能会同时记录日志信息。如果所有线程都往一个共享的日志列表中添加日志记录，使用 Vector 能确保每条日志记录都能正确地添加到列表中。

## Map容器


## 总结
